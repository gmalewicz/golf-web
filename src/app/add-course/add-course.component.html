<div *ngIf="!display" class="d-flex justify-content-center">
  <span class="spinner-border text-success" style="width: 3rem; height: 3rem;" role="status"></span>
</div>
<div *ngIf="display">
  <div class="container-float">
    <form [formGroup]="newCourseForm">
      <div class="row">
        <div class="col-auto">
          <mat-form-field class="course-name-width">
            <mat-label i18n="@@addCourse-name">Course name</mat-label>
            <input matInput maxlength="100" [formControlName]="'courseName'"/>
            @if (f.courseName.invalid && f.courseName.errors.required) {
              <mat-error i18n="@@addCourse-courseReq">Course name is required</mat-error>
            }
          </mat-form-field>
        </div>
        <div class="col-auto">
          <mat-form-field>
            <mat-label i18n="@@addCourse-coursePar">Course par</mat-label>
            <input matInput maxlength="2" [formControlName]="'coursePar'"/>
            @if (f.coursePar.invalid && f.coursePar.errors.required) {
              <mat-error i18n="@@addCourse-courseParReq">Course par is required</mat-error>
            }
            @if (f.coursePar.invalid && f.coursePar.errors.pattern) {
              <mat-error i18n="@@addCourse-courseParRange">Course par must be a number from 30 to 79</mat-error>
            }
          </mat-form-field>
        </div>
        <div class="col-auto">
          <mat-form-field>
            <mat-label i18n="@@addCourse-noHoles">number of holes</mat-label>
            <mat-select [formControlName]="'nbrHolesDropDown'">
              @for (holeOption of nbrHoles; track holeOption) {
                <mat-option [value]="holeOption.value">{{holeOption.label}}</mat-option>
              }
            </mat-select>
            @if (f.nbrHolesDropDown.invalid && f.nbrHolesDropDown.errors) {
              <mat-error i18n="@@addCourse-holesReq">Number of holes is required</mat-error>
            }
          </mat-form-field>
        </div>
      </div>
    </form>
    <div>
      <canvas
        baseChart class="chart"
        [datasets]="barChartData"
        [labels]="barChartLabels"
        [options]="barChartOptions"
        [legend]="barChartLegend"
        [type]="barChartType"
      >
      </canvas>
    </div>
    <br/>

    <div class="row">
        <div class="col-1 golf-padding" style="cursor: default;" i18n="@@addCourse-hole">
          Hole:
        </div>
        <div class="col-9 btn-group-toggle flex-wrap" data-toggle="buttons">
          <label *ngFor="let hole of barChartLabels; let i = index" class="btn btn-outline-success buttonWidth input-hole" [ngClass]="holeSelectorActive[i]" (click)="selectHole(i)">
            {{ i + 1 }}
          </label>
        </div>
    </div>
    <br />
    <div class="row">
      <div class="col-1 golf-padding" style="cursor: default;">
        Par:
      </div>
      <div class="col-9 btn-group-toggle flex-wrap" data-toggle="buttons">
        <label *ngFor="let par of parButtons; let i = index" class="btn btn-outline-success buttonWidth input-par" [ngClass]="parSelectorActive[i]" (click)="selectPar(par)">
          {{ par }}
        </label>
      </div>
    </div>
    <br/>
    <div class="row">
      <div class="col-1 golf-padding" style="cursor: default;">
        SI:
      </div>
      <div class="col-9 btn-group-toggle flex-wrap" data-toggle="buttons">
        <label *ngFor="let si of barChartLabels; let i = index" class="btn btn-outline-success buttonWidth input-si" [ngClass]="siSelectorActive[i]" (click)="selectSi(i)">
          {{ i + 1 }}
        </label>
      </div>
    </div>
    <div *ngIf="tees.length > 0">
      <table id="tee-tbl" class="table table-striped" aria-describedby="Add tee">
        <thead>
          <tr>
            <th id="tee">Tee</th>
            <th id="cr">CR</th>
            <th id="sr">SR</th>
            <th id="type" i18n="@@addCourse-type">Type</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of tees">
            <td>{{ row.tee }}
                <span *ngIf="row.sex" i18n="@@addCourse-ladies">ladies</span>
                <span *ngIf="!row.sex" i18n="@@addCourse-men">men</span>
            </td>
            <td>{{ row.cr }}</td>
            <td>{{ row.sr }}</td>
            <td *ngIf="row.teeType === 0">1-18</td>
            <td *ngIf="row.teeType === 1">1-9</td>
            <td *ngIf="row.teeType === 2">10-18</td>
          </tr>
        </tbody>
      </table>
    </div>
    <form [formGroup]="newCourseTeeForm">
      <br/>
      <div class="row">
        <div class="col-auto">
          <mat-form-field>
            <mat-label i18n="@@addCourse-colour">colour</mat-label>
            <input matInput maxlength="20" [formControlName]="'tee'"/>
            @if (g.tee.invalid && g.tee.errors.required)  {
              <mat-error i18n="@@addCourse-colourReq">Tee colour is required</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-auto">
          <mat-form-field>
            <mat-label>CR</mat-label>
            <input matInput maxlength="4" [formControlName]="'cr'"/>
            @if (g.cr.invalid && g.cr.errors.required)  {
              <mat-error i18n="@@addCourse-crReq">Course CR is required</mat-error>
            }
            @if (g.cr.invalid && g.cr.errors.pattern)  {
              <mat-error i18n="@@addCourse-crRange">Course CR must be in range: 20 to 89.9</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-auto">
          <mat-form-field>
            <mat-label>SR</mat-label>
            <input matInput maxlength="3" [formControlName]="'sr'"/>
            @if (g.sr.invalid && g.sr.errors.required)  {
              <mat-error i18n="@@addCourse-srReq">Course SR is required</mat-error>
            }
            @if (g.sr.invalid && g.sr.errors.pattern)  {
              <mat-error i18n="@@addCourse-srRange">Course SR must be in range: 10 to 299</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-auto">
          <mat-form-field>
            <mat-label i18n="@@addCourse-teeType">tee type</mat-label>
            <mat-select [formControlName]="'teeTypeDropDown'">
              @for (teeType of teeTypes; track teeType) {
                <mat-option [value]="teeType.value">{{teeType.label}}</mat-option>
              }
            </mat-select>
            @if (g.teeTypeDropDown.invalid  && g.teeTypeDropDown.errors) {
              <mat-error i18n="@@addCourse-teeReq">Tee is required</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-auto">
          <mat-form-field>
            <mat-label i18n="@@addCourse-sex">sex</mat-label>
            <mat-select [formControlName]="'sexDropDown'">
              @for (sexOpt of sex; track sexOpt) {
                <mat-option [value]="sexOpt.value">{{sexOpt.label}}</mat-option>
              }
            </mat-select>
            @if (g.sexDropDown.invalid  && g.sexDropDown.errors) {
              <mat-error i18n="@@addCourse-sexReq">Sex is required</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-auto">
          <button type="button" class="btn btn-success btn-tee" (click)="addTee()" i18n="@@addCourse-add">
            Add Tee
          </button>
        </div>

      </div>
    </form>
      <div>
        <br />
        <div>
          <button type="button" class="btn btn-success" routerLink="/home" i18n="@@addCourse-cancel">
            Cancel
          </button>
          &nbsp;
          <button type="button" class="btn btn-success btn-clear" (click)="clear()" i18n="@@addCourse-clear">
            Clear
          </button>
          &nbsp;
            <button [disabled]="loading" class="btn btn-success btn-submit" (click)="onSubmit()">
              <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
              <span i18n="@@addCourse-save">Save</span>
            </button>
        </div>
      </div>
  </div>

